<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JVM 基础 | 孤帆远影碧空尽</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/logo.png">
    <meta name="description" content="Hello World">
    
    <link rel="preload" href="/blog/assets/css/0.styles.f89f62fb.css" as="style"><link rel="preload" href="/blog/assets/js/app.376fd355.js" as="script"><link rel="preload" href="/blog/assets/js/3.b189d65b.js" as="script"><link rel="preload" href="/blog/assets/js/1.879802dd.js" as="script"><link rel="preload" href="/blog/assets/js/13.ec994a62.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d45cedd7.js"><link rel="prefetch" href="/blog/assets/js/100.5a14607c.js"><link rel="prefetch" href="/blog/assets/js/101.2848e75d.js"><link rel="prefetch" href="/blog/assets/js/102.ae245964.js"><link rel="prefetch" href="/blog/assets/js/103.7a0a31af.js"><link rel="prefetch" href="/blog/assets/js/104.c0208631.js"><link rel="prefetch" href="/blog/assets/js/105.08f627bd.js"><link rel="prefetch" href="/blog/assets/js/106.ce74de23.js"><link rel="prefetch" href="/blog/assets/js/107.60232031.js"><link rel="prefetch" href="/blog/assets/js/108.25ff2ae9.js"><link rel="prefetch" href="/blog/assets/js/109.df146d98.js"><link rel="prefetch" href="/blog/assets/js/11.4e4cb364.js"><link rel="prefetch" href="/blog/assets/js/110.405461c4.js"><link rel="prefetch" href="/blog/assets/js/111.3e9d7d1f.js"><link rel="prefetch" href="/blog/assets/js/112.1852ba0f.js"><link rel="prefetch" href="/blog/assets/js/113.fa80c1cb.js"><link rel="prefetch" href="/blog/assets/js/114.0c667c7d.js"><link rel="prefetch" href="/blog/assets/js/115.fe009604.js"><link rel="prefetch" href="/blog/assets/js/116.efa74254.js"><link rel="prefetch" href="/blog/assets/js/117.beb99b5a.js"><link rel="prefetch" href="/blog/assets/js/118.da210ebc.js"><link rel="prefetch" href="/blog/assets/js/119.75c03cac.js"><link rel="prefetch" href="/blog/assets/js/12.c64cda3f.js"><link rel="prefetch" href="/blog/assets/js/120.8da3584e.js"><link rel="prefetch" href="/blog/assets/js/121.aff465a2.js"><link rel="prefetch" href="/blog/assets/js/122.1fa947ec.js"><link rel="prefetch" href="/blog/assets/js/123.4f069c29.js"><link rel="prefetch" href="/blog/assets/js/124.ae4bebdd.js"><link rel="prefetch" href="/blog/assets/js/125.c51a9419.js"><link rel="prefetch" href="/blog/assets/js/126.07bc62c5.js"><link rel="prefetch" href="/blog/assets/js/127.6b66edd3.js"><link rel="prefetch" href="/blog/assets/js/128.8d6993c0.js"><link rel="prefetch" href="/blog/assets/js/129.9293770e.js"><link rel="prefetch" href="/blog/assets/js/130.5799d10e.js"><link rel="prefetch" href="/blog/assets/js/131.558a76cc.js"><link rel="prefetch" href="/blog/assets/js/132.fdd8ef22.js"><link rel="prefetch" href="/blog/assets/js/133.2bd333a5.js"><link rel="prefetch" href="/blog/assets/js/134.749e4913.js"><link rel="prefetch" href="/blog/assets/js/135.b924ca55.js"><link rel="prefetch" href="/blog/assets/js/136.d4459689.js"><link rel="prefetch" href="/blog/assets/js/137.47e60464.js"><link rel="prefetch" href="/blog/assets/js/138.ffcd8420.js"><link rel="prefetch" href="/blog/assets/js/139.4e8657cc.js"><link rel="prefetch" href="/blog/assets/js/14.a64f4a85.js"><link rel="prefetch" href="/blog/assets/js/15.a3c458fa.js"><link rel="prefetch" href="/blog/assets/js/16.c5320ff3.js"><link rel="prefetch" href="/blog/assets/js/17.e5cc49ce.js"><link rel="prefetch" href="/blog/assets/js/18.c65fc88b.js"><link rel="prefetch" href="/blog/assets/js/19.a0acb197.js"><link rel="prefetch" href="/blog/assets/js/20.9a857ced.js"><link rel="prefetch" href="/blog/assets/js/21.d6ac45da.js"><link rel="prefetch" href="/blog/assets/js/22.e1bf8d2e.js"><link rel="prefetch" href="/blog/assets/js/23.84076d2d.js"><link rel="prefetch" href="/blog/assets/js/24.ddbbc94a.js"><link rel="prefetch" href="/blog/assets/js/25.ef809c33.js"><link rel="prefetch" href="/blog/assets/js/26.b85a21de.js"><link rel="prefetch" href="/blog/assets/js/27.99fc5f16.js"><link rel="prefetch" href="/blog/assets/js/28.59eaeab1.js"><link rel="prefetch" href="/blog/assets/js/29.2250a0a0.js"><link rel="prefetch" href="/blog/assets/js/30.ac337600.js"><link rel="prefetch" href="/blog/assets/js/31.dc808c89.js"><link rel="prefetch" href="/blog/assets/js/32.0321e900.js"><link rel="prefetch" href="/blog/assets/js/33.80c069cc.js"><link rel="prefetch" href="/blog/assets/js/34.cc49e8be.js"><link rel="prefetch" href="/blog/assets/js/35.7a6a516a.js"><link rel="prefetch" href="/blog/assets/js/36.ba487a1d.js"><link rel="prefetch" href="/blog/assets/js/37.10b5ca73.js"><link rel="prefetch" href="/blog/assets/js/38.928e149f.js"><link rel="prefetch" href="/blog/assets/js/39.bb54289e.js"><link rel="prefetch" href="/blog/assets/js/4.ea05c3a5.js"><link rel="prefetch" href="/blog/assets/js/40.247ec10e.js"><link rel="prefetch" href="/blog/assets/js/41.aaf94c22.js"><link rel="prefetch" href="/blog/assets/js/42.81f4d80b.js"><link rel="prefetch" href="/blog/assets/js/43.51f8508a.js"><link rel="prefetch" href="/blog/assets/js/44.e5ddc54e.js"><link rel="prefetch" href="/blog/assets/js/45.7727d2e9.js"><link rel="prefetch" href="/blog/assets/js/46.19e46053.js"><link rel="prefetch" href="/blog/assets/js/47.c9be7c81.js"><link rel="prefetch" href="/blog/assets/js/48.696ba346.js"><link rel="prefetch" href="/blog/assets/js/49.07bdad32.js"><link rel="prefetch" href="/blog/assets/js/5.b3cea744.js"><link rel="prefetch" href="/blog/assets/js/50.2ed34d6c.js"><link rel="prefetch" href="/blog/assets/js/51.f1b64434.js"><link rel="prefetch" href="/blog/assets/js/52.abb269a2.js"><link rel="prefetch" href="/blog/assets/js/53.8c580858.js"><link rel="prefetch" href="/blog/assets/js/54.26777cb7.js"><link rel="prefetch" href="/blog/assets/js/55.1f46192d.js"><link rel="prefetch" href="/blog/assets/js/56.d052d71f.js"><link rel="prefetch" href="/blog/assets/js/57.9a47b310.js"><link rel="prefetch" href="/blog/assets/js/58.778ac578.js"><link rel="prefetch" href="/blog/assets/js/59.1b0db36f.js"><link rel="prefetch" href="/blog/assets/js/6.d41bd7f1.js"><link rel="prefetch" href="/blog/assets/js/60.f6037171.js"><link rel="prefetch" href="/blog/assets/js/61.a205f0ba.js"><link rel="prefetch" href="/blog/assets/js/62.24e43c2c.js"><link rel="prefetch" href="/blog/assets/js/63.db424bbc.js"><link rel="prefetch" href="/blog/assets/js/64.b613db40.js"><link rel="prefetch" href="/blog/assets/js/65.618078df.js"><link rel="prefetch" href="/blog/assets/js/66.1787474c.js"><link rel="prefetch" href="/blog/assets/js/67.44cdb078.js"><link rel="prefetch" href="/blog/assets/js/68.2bc8117e.js"><link rel="prefetch" href="/blog/assets/js/69.c0e055ad.js"><link rel="prefetch" href="/blog/assets/js/7.24375669.js"><link rel="prefetch" href="/blog/assets/js/70.18cfc28b.js"><link rel="prefetch" href="/blog/assets/js/71.40510230.js"><link rel="prefetch" href="/blog/assets/js/72.fee1b3ce.js"><link rel="prefetch" href="/blog/assets/js/73.79aa89b1.js"><link rel="prefetch" href="/blog/assets/js/74.89c2ffa2.js"><link rel="prefetch" href="/blog/assets/js/75.51b549c4.js"><link rel="prefetch" href="/blog/assets/js/76.8fd3e4a5.js"><link rel="prefetch" href="/blog/assets/js/77.8375b713.js"><link rel="prefetch" href="/blog/assets/js/78.ba063c91.js"><link rel="prefetch" href="/blog/assets/js/79.ad23fe81.js"><link rel="prefetch" href="/blog/assets/js/8.0078e5e4.js"><link rel="prefetch" href="/blog/assets/js/80.7bbf4603.js"><link rel="prefetch" href="/blog/assets/js/81.a1dce204.js"><link rel="prefetch" href="/blog/assets/js/82.d0a572e9.js"><link rel="prefetch" href="/blog/assets/js/83.fe13a04d.js"><link rel="prefetch" href="/blog/assets/js/84.abba52b3.js"><link rel="prefetch" href="/blog/assets/js/85.7b964b78.js"><link rel="prefetch" href="/blog/assets/js/86.4c666651.js"><link rel="prefetch" href="/blog/assets/js/87.5c8d8af6.js"><link rel="prefetch" href="/blog/assets/js/88.ba4c33a5.js"><link rel="prefetch" href="/blog/assets/js/89.d80b21b3.js"><link rel="prefetch" href="/blog/assets/js/9.3e96f7be.js"><link rel="prefetch" href="/blog/assets/js/90.3dc3f5d5.js"><link rel="prefetch" href="/blog/assets/js/91.cd2a8802.js"><link rel="prefetch" href="/blog/assets/js/92.693eb779.js"><link rel="prefetch" href="/blog/assets/js/93.8a376590.js"><link rel="prefetch" href="/blog/assets/js/94.2ffc579a.js"><link rel="prefetch" href="/blog/assets/js/95.53e6745d.js"><link rel="prefetch" href="/blog/assets/js/96.586fa017.js"><link rel="prefetch" href="/blog/assets/js/97.e26363b5.js"><link rel="prefetch" href="/blog/assets/js/98.7dd7f796.js"><link rel="prefetch" href="/blog/assets/js/99.fb219355.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.f89f62fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>孤帆远影碧空尽</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>Hello World</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>鱼丸粗面</span>
            
          <span data-v-25ba6db2>2019 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">孤帆远影碧空尽</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/c++/" class="nav-link"><i class="undefined"></i>
  c++
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/c/" class="nav-link"><i class="undefined"></i>
  c
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/clickhouse/" class="nav-link"><i class="undefined"></i>
  clickhouse
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/mysql/" class="nav-link"><i class="undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/design patterns/" class="nav-link"><i class="undefined"></i>
  design patterns
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/juc/" class="nav-link"><i class="undefined"></i>
  juc
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/aqs/" class="nav-link"><i class="undefined"></i>
  aqs
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/集合/" class="nav-link"><i class="undefined"></i>
  集合
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/jvm/" class="nav-link"><i class="undefined"></i>
  jvm
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/mq/" class="nav-link"><i class="undefined"></i>
  mq
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/spring/" class="nav-link"><i class="undefined"></i>
  spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/spring boot/" class="nav-link"><i class="undefined"></i>
  spring boot
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Java
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/blog/jvm/" class="nav-link router-link-active"><i class="undefined"></i>
  Jvm
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      开源框架
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/spring/" class="nav-link"><i class="undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/dubbo/" class="nav-link"><i class="undefined"></i>
  Dubbo
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      数据库
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/db/mysql/" class="nav-link"><i class="undefined"></i>
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/redis/" class="nav-link"><i class="undefined"></i>
  Redis
</a></li></ul></div></div><div class="nav-item"><a href="/blog/mq/" class="nav-link"><i class="undefined"></i>
  消息中间件
</a></div> <a href="https://github.com/lasilaso/blog" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><img src="logo.png" alt="author-avatar" class="personal-img" data-v-39576ba9> <h3 class="name" data-v-39576ba9>
    鱼丸粗面
  </h3> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>117</h3> <h6 data-v-39576ba9>文章</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>25</h3> <h6 data-v-39576ba9>标签</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/c++/" class="nav-link"><i class="undefined"></i>
  c++
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/c/" class="nav-link"><i class="undefined"></i>
  c
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/clickhouse/" class="nav-link"><i class="undefined"></i>
  clickhouse
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/mysql/" class="nav-link"><i class="undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/design patterns/" class="nav-link"><i class="undefined"></i>
  design patterns
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/juc/" class="nav-link"><i class="undefined"></i>
  juc
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/aqs/" class="nav-link"><i class="undefined"></i>
  aqs
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/集合/" class="nav-link"><i class="undefined"></i>
  集合
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/jvm/" class="nav-link"><i class="undefined"></i>
  jvm
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/mq/" class="nav-link"><i class="undefined"></i>
  mq
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/spring/" class="nav-link"><i class="undefined"></i>
  spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/spring boot/" class="nav-link"><i class="undefined"></i>
  spring boot
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Java
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/blog/jvm/" class="nav-link router-link-active"><i class="undefined"></i>
  Jvm
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      开源框架
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/spring/" class="nav-link"><i class="undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/dubbo/" class="nav-link"><i class="undefined"></i>
  Dubbo
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      数据库
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/db/mysql/" class="nav-link"><i class="undefined"></i>
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/redis/" class="nav-link"><i class="undefined"></i>
  Redis
</a></li></ul></div></div><div class="nav-item"><a href="/blog/mq/" class="nav-link"><i class="undefined"></i>
  消息中间件
</a></div> <a href="https://github.com/lasilaso/blog" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Jvm专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/jvm/jvm.html" aria-current="page" class="active sidebar-link">JVM 基础</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>JVM 基础</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>鱼丸粗面</span>
            
          <span data-v-25ba6db2>2019 - </span>
          2022
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title">JVM 基础</h1> <div data-v-f875f3fc><i class="iconfont reco-account" data-v-f875f3fc><span data-v-f875f3fc>鱼丸粗面</span></i> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>2020/10/27</span></i> <!----> <i class="tags iconfont reco-tag" data-v-f875f3fc><span class="tag-item" data-v-f875f3fc>java</span><span class="tag-item" data-v-f875f3fc>jvm</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="jvm-内存区域"><a href="#jvm-内存区域" class="header-anchor">#</a> JVM 内存区域</h2> <p><strong>注, 方法区是JVM规范所定义的, 元空间是jdk 1.8之后的 Hotspot 对方法区的实现.</strong></p> <h3 id="线程私有"><a href="#线程私有" class="header-anchor">#</a> 线程私有</h3> <h4 id="虚拟机栈"><a href="#虚拟机栈" class="header-anchor">#</a> 虚拟机栈</h4> <p>Java方法的执行都是在虚拟机栈中进行的.</p> <h4 id="本地方法栈"><a href="#本地方法栈" class="header-anchor">#</a> 本地方法栈</h4> <p>本地方法栈是为了执行Java中的native方法.</p> <h4 id="程序计数器"><a href="#程序计数器" class="header-anchor">#</a> 程序计数器</h4> <p>程序计数器是线程私有的, 它保存了线程执行到哪一行的字节码的编号.</p> <h3 id="线程共享"><a href="#线程共享" class="header-anchor">#</a> 线程共享</h3> <h4 id="方法区"><a href="#方法区" class="header-anchor">#</a> 方法区</h4> <p>存放class元数据和常量池.</p> <h4 id="堆"><a href="#堆" class="header-anchor">#</a> 堆</h4> <p>运行时数据区.</p> <h5 id="tlab"><a href="#tlab" class="header-anchor">#</a> TLAB</h5> <p>全称是Thread Local Allocation Buffer, 栈上分配, 默认启用, 它的意思是, 在Eden空间, 会为每一个线程分配一块内存, 这样线程就可以优先在TLAB上进行分配, 大内存对象还是需要在堆上分配.</p> <p><strong>TLAB很复杂, 我这里只是稍微提一下这个概念</strong>.</p> <h2 id="如何判断对象死亡"><a href="#如何判断对象死亡" class="header-anchor">#</a> 如何判断对象死亡</h2> <h3 id="引用计数算法"><a href="#引用计数算法" class="header-anchor">#</a> 引用计数算法</h3> <p>引用计数算法的概念相对简单, 对象每多一个指向它的变量, 引用计数+1; 每少一个指向它的变量, 引用计数-1.</p> <p>它的问题在于, 没有办法处理对象循环引用的情况.</p> <h3 id="可达性分析算法"><a href="#可达性分析算法" class="header-anchor">#</a> 可达性分析算法</h3> <p>现代虚拟机基本都采用的这种算法来判断对象是否存活, 它的原理是, 通过一组叫GC Root的对象出发, 引出他们指向的下一个节点, 然后再以下一个节点为起点, 引出再下一个节点, 以此类推, 知道遍历完所有节点, 那只要是不在引用链上的对象, 都是可以被回收的. 这样, 就解决了循环引用的问题.</p> <h4 id="gc-root"><a href="#gc-root" class="header-anchor">#</a> GC Root</h4> <p>那有哪些对象可以作为GC Root呢? 下面简单列举下,</p> <ul><li>虚拟机栈(栈帧中的本地变量表)中引用的对象</li> <li>本地方法栈中JNI(即native)引用的对象</li> <li>方法区中类静态变量引用的对象</li> <li>常量池中常量引用的对象</li> <li>Class Loader</li> <li>CodeCache(存放的是Java热点代码的JIT编译结果)</li></ul> <h2 id="了解哪些-gc-算法"><a href="#了解哪些-gc-算法" class="header-anchor">#</a> 了解哪些 GC 算法</h2> <h3 id="标记-清除算法"><a href="#标记-清除算法" class="header-anchor">#</a> 标记-清除算法</h3> <p>标记清除的原理很简单, 大概可分为两步,</p> <ol><li>通过可达性分析标记出需要回收的对象,</li> <li>回收这些对象.</li></ol> <p>标记清除的问题在于, 会造成大量的内存碎片.</p> <h3 id="标记-整理算法"><a href="#标记-整理算法" class="header-anchor">#</a> 标记-整理算法</h3> <p>标记整理的原理算是对标记清除的完善, 大概可分为三步,</p> <ol><li>通过可达性分析标记出需要回收的对象,</li> <li>将所有存活对象都往一段移动,紧邻排列,</li> <li>清理另一端的区域, 完成回收操作.</li></ol> <p>标记整理虽然解决了标记清除算法的内存碎片问题, 但是缺点也很明显, 就是每次GC都需要频繁移动存活的对象, 效率比较低.</p> <h3 id="标记-复制算法"><a href="#标记-复制算法" class="header-anchor">#</a> 标记-复制算法</h3> <p>标记复制的原理大概可分为以下几步,</p> <ol><li>首先, 将内存区域分为两块, A和B, 每次只用其中一块分配对象,</li> <li>通过可达性分析标记出区域A中的存活对象,</li> <li>把上述存活对象移动到B区域, 紧邻排列,</li> <li>回收整个A区域.</li></ol> <p>标记复制算法同样解决了标记清除算法的内存碎片问题, 但是缺点也很明显, 首先, 区域被分成了两块, 每次分配对象只用其中一块, 导致可分配对象的空间变小; 其次, 它同样需要复制存活对象到另一个区域, 效率比较低.</p> <h3 id="三种算法简要对比"><a href="#三种算法简要对比" class="header-anchor">#</a> 三种算法简要对比</h3> <table><thead><tr><th></th> <th>mark-sweep</th> <th>mark-compact</th> <th>mark-copy(copying)</th></tr></thead> <tbody><tr><td>速度</td> <td>中等</td> <td>最慢</td> <td>最快</td></tr> <tr><td>空间开销</td> <td>少（但会堆积碎片）</td> <td>少（不堆积碎片）</td> <td>通常需要活对象的2倍大小（不堆积碎片）</td></tr> <tr><td>是否移动对象</td> <td>否</td> <td>是</td> <td>是</td></tr></tbody></table> <h3 id="分代回收算法-策略"><a href="#分代回收算法-策略" class="header-anchor">#</a> 分代回收算法(策略)</h3> <p>分代回收算法, 实际上是整合了以上算法, 综合了上述算法的优点, 并且最大限度的避免了上述算法的缺点, 所以是现代虚拟机(jdk11以前)的首选算法, 与其说它是算法, 不如称它是一种策略.</p> <p>首先, 我们考虑下, 为什么要分代回收呢? 根据一些专业研究表明, JVM中的对象, 实际上是朝生夕死的, 也就是说, 大部分对象, 经过一次Minor GC就会被回收掉了.</p> <p>所以, 分代回收算法将堆空间分成了新生代和老年代, 默认比例是1 : 2; 然后又将新生代分为了Eden区, From Survivor区(S0), To Survivor区(S1), 默认比例是8 : 1 : 1.</p> <p>一般, 把新生代的GC叫做Young GC(或者Minor GC), 把老年代的GC叫做Full GC(或者Major GC).</p> <h4 id="新生代"><a href="#新生代" class="header-anchor">#</a> 新生代</h4> <p>简单说下对象在新生代的分配和GC过程,</p> <ol><li>首先, 对象会先在Eden区进行分配,</li> <li>当Eden区快满时, 会触发Minor GC, 由于上文提到过, Minor GC会把大部分对象回收, 所以只有很少一部分对象会存活, 此时, 将存活对象移到S0区, 并且对象的年龄+1, 然后清空Eden区以释放空间,</li> <li>当下一次触发Minor GC时, 会把Eden区和S0区的存活对象移动到S1区, 同时年龄+1, 然后同时清空Eden区和S0区,</li> <li>当再一次触发Minor GC时, 会再把Eden区和S1区的存活对象移动带S0区, 同时年龄+1, 然后同时清空Eden区和S1区,</li> <li>也就是说, 每次发生Minor GC之后, S0区和S1区会角色互换, 这样也可以看出, 在新生代, 采用的是<strong>标记复制算法</strong>,</li> <li>因为在每次Minor GC发生后, 只会剩下很少的存活对象(这也是Eden : S0 : S1的区域默认是8 : 1 : 1的原因), S0区和S1区比较小, 这也最大限度的降低了复制算法造成的对象拷贝带来的开销.</li></ol> <h4 id="对象何时晋升老年代"><a href="#对象何时晋升老年代" class="header-anchor">#</a> 对象何时晋升老年代</h4> <ul><li>当对象的年龄达到了设定的晋升阈值(默认是15, 同时, 因为对象头中的保存的age只占4bit, 所以最大也是15), 则会从S0或者S1区晋升老年代,</li> <li>大对象会直接在老年代进行分配,</li> <li>当S0区或者S1区相同年龄的对象大小之和大于S0或者S1区的一半时, 所有大于该年龄的对象都会晋升老年代.</li></ul> <h4 id="空间分配担保机制"><a href="#空间分配担保机制" class="header-anchor">#</a> 空间分配担保机制</h4> <p>在发生Minor GC之前, 虚拟机会首先检查老年代最大可用的连续空间是否大于新生代所有对象的总空间, 如果大于, 那么Minor GC会直接执行; 如果不大于, 那么虚拟机会查看HandlePromotionFailure设置值是否允许担保失败, 如果允许, 那么虚拟机会检查老年代最大可用的连续空间是否大于历次晋升到老年代的对象的平均大小, 如果大于, 则进行Minor GC, 如果不大于, 则可能进行一次Full GC.</p> <h4 id="老年代"><a href="#老年代" class="header-anchor">#</a> 老年代</h4> <p>如果老年代满了, 则会触发Full GC(这里的说法不太严谨, 在最后的总结中, 会对几种GC名称进行说明), 它会同时回收新生代和老年代(即对整个堆空间进行GC),</p> <p>一般, Full GC会导致工作线程停顿时间较长(因为它会回收整个堆中的不可用对象), 如果此时server收到很多请求, 可能会导致拒绝服务, 所以, 我们要尽量减少Full GC的出现,</p> <p>所以, 到这里, 我们也可以大概明白, 为什么要将新生代和老年代的比例设置为1 : 2, 为什么要将新生代分为Eden, S0, S1, 为什么要有对象年龄的设定, 归根结底, 都是为了让对象尽量少的进入老年代, 这样, 也就能降低Full GC发生的次数,</p> <p>另外, 需要特别说明的是, 由于老年代的对象都是存活的时间比较长, 或者内存占用比较大, 如果采用复制算法会造成很大的开销并且会降低空间的使用率, 所以, 在老年代, 使用的是<strong>标记整理算法</strong>(CMS采用的是标记清除算法).</p> <p><strong>关于老年代的垃圾回收过程, 可参考下文对CMS 垃圾收集器的详情分析.</strong></p> <h4 id="stop-the-world"><a href="#stop-the-world" class="header-anchor">#</a> Stop The World</h4> <p>STW就是说, 在GC(Minor GC或者Full GC)期间, 只有垃圾回收线程在执行, 其他工作线程都被挂起.</p> <h4 id="safe-point"><a href="#safe-point" class="header-anchor">#</a> Safe Point</h4> <p>由于Full GC(Minor GC也会影响, 但比较轻微)会影响性能, 所以虚拟机需要在一个合适的时间点发起GC, 这个时间点就被称为Safe Point.</p> <p>一般来说, 当线程在这个时间点的状态是可以确定的, 那么就可以使JVM开始安全的GC, Safe Point主要包括以下几个特定位置,</p> <ul><li>循环的末尾,</li> <li>方法返回前,</li> <li>调用方法的call之后,</li> <li>抛出异常的位置.</li></ul> <h4 id="永久代"><a href="#永久代" class="header-anchor">#</a> <s>永久代</s></h4> <p>指的是内存永久保留的区域, 主要存放Class和Meta(元数据)的信息, Class在加载的时候被放入这个区域, 由于GC不会对永久代进行回收, 这就导致, 如果Class过多, 会导致永久代膨胀, 进而抛出OOM异常.</p> <h4 id="元空间"><a href="#元空间" class="header-anchor">#</a> 元空间</h4> <p>在jdk 1.8之后, 永久代已经被废除了, 取而代之的是元空间, 元空间的本质和永久代差不多, 只不过元空间不在虚拟机中, 而是使用了本地内存, 所以, 默认情况下, 元空间仅受本地内存的大小限制.</p> <h3 id="基于region的回收策略"><a href="#基于region的回收策略" class="header-anchor">#</a> 基于region的回收策略</h3> <p><strong>参考下文对G1 垃圾收集器的执行原理.</strong></p> <h2 id="了解哪些垃圾收集器"><a href="#了解哪些垃圾收集器" class="header-anchor">#</a> 了解哪些垃圾收集器</h2> <p>Java虚拟机规范并没有规定垃圾收集器应该如何实现, 所以, 不同版本的虚拟机提供的垃圾收集器可能有所区别, 并且会提供参数让用户选择不同的收集器配合使用, 目前主要有以下几种垃圾收集器.</p> <p><img src="/blog/assets/img/garbage-collector.052b21b3.jpeg" alt="garbage-collector"></p> <p>图中的收集器, 如果有连线连接, 代表可以配合使用.</p> <h3 id="新生代-2"><a href="#新生代-2" class="header-anchor">#</a> 新生代</h3> <h4 id="serial-收集器"><a href="#serial-收集器" class="header-anchor">#</a> Serial 收集器</h4> <p><strong>单线程, 复制算法.</strong></p> <p>Serial 收集器工作在新生代, 它是单线程的收集器, 单线程就意味着它只会使用一个CPU或一个收集线程来完成垃圾回收. 并且, 它在收集过程中, 会暂停其他工作线程, 直至垃圾收集结束. 也就是说在GC期间, 应用不可用.</p> <p>在Client模式下, Serial单线程模式无需与其他线程进行交互, 减少了开销, 能专心进行GC; 另外, 在桌面应用场景下, 分配给虚拟机的内存不会太大, 几十兆或者一二百兆的内存回收, STW的时间基本在100毫秒左右, 只要不是频繁发生, 这点停顿是可以接收的.</p> <p>所以, Serial收集器是Client模式下新生代的默认收集器.</p> <h4 id="parnew-收集器"><a href="#parnew-收集器" class="header-anchor">#</a> ParNew 收集器</h4> <p><strong>多线程, 复制算法, Serial的升级版.</strong></p> <p>ParNew 收集器, 其实就是Serial的多线程版本, 它主要工作在Server模式下, 多线程让垃圾回收的更快, 也就减少了STW的时间, 也就提升了应用的响应速度, 还有一个原因是, ParNew是除了Serial收集器之外, 唯一可以与CMS收集器配合使用的,</p> <p>ParNew 收集器通过多线程收集, 减少了STW的时间, 所以更适合一些与用户进行交互的场景, 因为, 停顿时间越短, 用户体验越好.</p> <p>所以, ParNew 收集器一般是Server模式下新生代的默认收集器.</p> <h5 id="可配置参数"><a href="#可配置参数" class="header-anchor">#</a> 可配置参数</h5> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td><code>-XX:+UseConcMarkSweepGC</code></td> <td>可指定老年代使用CMS收集器, 而新生代就会默认选用ParNew 收集器</td></tr> <tr><td><code>-XX:+UseParNewGC</code></td> <td>可强制使用ParNew 收集器作为新生代收集器</td></tr> <tr><td><code>-XX:ParallelGCThreads=n</code></td> <td>可指定垃圾收集器的线程数量, 默认和CPU核心数一致</td></tr></tbody></table> <h4 id="parallel-scavenge-收集器"><a href="#parallel-scavenge-收集器" class="header-anchor">#</a> Parallel Scavenge 收集器</h4> <p><strong>多线程, 复制算法.</strong></p> <p>Parallel Scavenge 收集器, 也是基于复制算法实现的多线程收集器, 它和ParNew的区别是关注点不同, Parallel Scavenge的目标是达到一个可控制的吞吐量(吞吐量=运行用户代码时间/(运行用户代码时间+垃圾回收时间)), 所以更适合一些后台计算等不需要太多与用户交互的任务,</p> <p>Parallel Scavenge 收集器提供了两个参数来精确的控制吞吐量, 分别是控制最大垃圾收集时间的<code>-XX:MaxGCPauseMillis</code>参数, 以及直接控制吞吐量的<code>-XX:GCTimeRatio</code>(默认99%)参数,</p> <p>并且, Parallel Scavenge 收集器还可以通过指定<code>-XX:UseAdaptiveSizePolicy</code>开启堆的自适应策略, 一旦开启之后, 就无须手动指定新生代大小, Eden, S0, S1的比例等, 只需要设置好基本的堆大小(-Xmx设置最大堆), 以及最大垃圾收集时间与吞吐量大小, 虚拟机就会根据当前系统运行情况收集监控信息, 动态调整这些参数以尽可能地达到我们设定的最大垃圾收集时间或吞吐量大小这两个指标, 这也是它与ParNew收集器的一个重要区别.</p> <h5 id="parallel-scavenge-垃圾收集器的工作原理"><a href="#parallel-scavenge-垃圾收集器的工作原理" class="header-anchor">#</a> Parallel Scavenge 垃圾收集器的工作原理</h5> <p><s>懒得写了.</s></p> <h5 id="可配置参数-2"><a href="#可配置参数-2" class="header-anchor">#</a> 可配置参数</h5> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td><code>-XX:MaxGCPauseMillis=n</code></td> <td>指定最大垃圾收集时间</td></tr> <tr><td><code>-XX:GCTimeRatio=n</code></td> <td>指定吞吐量</td></tr> <tr><td><code>-XX:+UseAdaptiveSizePolicy</code></td> <td>开启堆的自适应策略</td></tr></tbody></table> <h3 id="老年代-2"><a href="#老年代-2" class="header-anchor">#</a> 老年代</h3> <h4 id="serial-old-收集器"><a href="#serial-old-收集器" class="header-anchor">#</a> Serial Old 收集器</h4> <p><strong>单线程, 标记整理算法.</strong></p> <p>Serial Old 收集器是工作于老年代的单线程收集器, 它主要在给Client模式下的虚拟机使用,</p> <p>在Server模式下, 它有两个作用, 一个是在jdk 1.5及之前, 配合Parallel Scavenge收集器使用, 另一个是作为CMS收集器的备选方案, 当CMS收集器发生Concurrent Mode Failure时使用(后面会讲).</p> <h4 id="parallel-old-收集器"><a href="#parallel-old-收集器" class="header-anchor">#</a> Parallel Old 收集器</h4> <p><strong>多线程, 标记整理算法.</strong></p> <p>Parallel Old 收集器是Parallel Scavenge 收集器的老年代版本, 基于整理算法实现的多线程收集器, 只能配合Parallel Scavenge收集器使用, 二者联合, 真正实现了<strong>吞吐量优先</strong>的目标.</p> <h5 id="可配置参数-3"><a href="#可配置参数-3" class="header-anchor">#</a> 可配置参数</h5> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td><code>-XX:+UseParallelOldGC</code></td> <td>指定使用Parallel Old 收集器作为老年代收集器</td></tr></tbody></table> <p><strong>注: 到目前为止, 上述提到的垃圾收集器, 在整个GC期间都是STW的.</strong></p> <h4 id="cms-收集器"><a href="#cms-收集器" class="header-anchor">#</a> CMS 收集器</h4> <p><strong>多线程, 标记清除算法.</strong></p> <p>Concurrent Mark Sweep, 顾名思义, 它是一款并发的, 基于清除算法实现的收集器, 并且, <strong>CMS只会收集老年代</strong>,</p> <p>CMS的目标是<strong>最小的停顿时间</strong>, 所以它的应用场景就和ParNew 收集器较为类似, 都适合一些与用户交互比较多的场景, 因为停顿越少, 用户体验越好(而默认情况下, CMS就是搭配ParNew使用的).</p> <h5 id="cms垃圾收集器的工作原理"><a href="#cms垃圾收集器的工作原理" class="header-anchor">#</a> CMS垃圾收集器的工作原理</h5> <ol><li><p><strong>初始标记(STW)</strong>, 初始标记阶段需要STW, 在该阶段会进行可达性分析, 标记所有能和GC Root<strong>直接关联</strong>的对象, 一般来说, 耗时较短,</p></li> <li><p><strong>并发标记</strong>, 并发标记阶段是和用户线程并发执行的, 在第一个阶段被暂停的线程重新启动, 该阶段进行GC Root Tracing, 直到标记完所以可达对象,</p></li> <li><p><strong>并发预清理</strong>, 此节点标记从新生代晋升的对象, 新分配到老年代的对象, 并发阶段被修改了的对象, 并且, 这个阶段还会扫描新生代,</p> <p>那为什么CMS不回收新生代还要扫描新生代呢? 答案很简单, 由于CMS只回收老年代, 那对于老年代来说, 新生代的对象就是不可收集的集合, 那一旦有新生代的对象持有老年代对象的引用, 那这个老年代的对象就肯定不能回收的.</p> <p>那再思考个问题, 如果全量的扫描新生代和老年代的所有对象, 会不会很慢?</p> <p>如果没有特殊处理, 肯定会很慢, 但是我们都知道, 新生代的对象一般都是朝生夕死的, 所以, 如果能在新生代先进行一次Minor GC, 再去扫描, 就会很快, 所以, 在预清理之后, CMS会判断是否要进入<strong>可中断并发预清理</strong>,</p></li> <li><p><strong>可中断并发预清理</strong>, 可中断并发预清理的目的, 就是希望能在进入重新标记之前触发一次Minor GC, 这样可以尽量缩短重新标记阶段的停顿时长,</p> <ol><li>CMS提供了两个参数, <code>-XX:CMSScheduleRemarkEdenSizeThreshold</code>(Eden区大小阈值配置, 默认2M)和<code>-XX:CMSScheduleRemarkEdenPenetration</code>(Eden区使用率阈值配置, 默认50%), <s>当Eden区的使用空间小于配置或者Eden区的使用率小于配置时, 才会进入可中断的并发预清理, 否则, 直接进入重新标记阶段(这里还有些疑问?)</s>,</li> <li>当然, 可中断并发预清理也不会一直执行, CMS也提供了两个参数, <code>-XX:CMSMaxAbortablePrecleanLoops</code>(执行次数, 默认0)和<code>-XX:CMSMaxAbortablePrecleanTime</code>(执行时间, 默认5s), 这两个条件只要满足一个, 就会退出,</li></ol></li> <li><p><strong>重新标记(STW)</strong>, 重新标记阶段会STW,</p> <ol><li>可以配置<code>-XX:ParallelCMSThreads</code>(默认是(CPU+3)/4)参数启用并发收集,</li> <li>注意, 在当前阶段会再一次从GC Root出发, 进行可达性分析, 标记存活对象, 这个阶段将会扫描GC Root , 新生代的对象, cart 被标记为dirty的老年代对象,</li> <li>所以, 如果预清理的工作完成的不好或者新生代对象比较多, 都会导致重新标记阶段停顿较长, 那么, CMS也提供了<code>-XX:+CMSScavengeBeforeRemark</code>参数, 即在进入重新标记阶段之前, 强行启动一次Minor GC, 但是这个参数要谨慎使用.</li></ol></li> <li><p><strong>并发清理</strong>, 与用户线程并发执行, 清理所有垃圾对象,</p></li> <li><p><strong>重置</strong>, 重置CMS回收器的状态, 准备进入下一个并发回收的周期.</p></li></ol> <h5 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h5> <ol><li><strong>停顿时间比较短</strong>,</li></ol> <h5 id="不足"><a href="#不足" class="header-anchor">#</a> 不足</h5> <ol><li><strong>抢占CPU资源</strong>, 因为CMS是并发收集的, 那么在GC过程中, 不可避免的就会与用户线程抢占CPU, 这可能会导致用户线程的执行效率下降, CMS默认启用的回收线程是(CPU+3)/4个,</li> <li><strong>浮动垃圾</strong>, 由于CMS在最终的清理阶段是和用户线程并发执行的, 那么在这个阶段新产生的垃圾就只能等到下一次GC时清理. 这里还有个问题是, 到底要在什么时候启动CMS GC? 因为垃圾回收阶段, 用户线程还在运行, 所以必须留有足够的空间给用户线程, 不然, 一旦老年代的内存空间不够分配对象的话(会产生 Concurrent  Mode Failure错误), 就会退化为备选方案, 使用Serial Old 收集器进行一次Full GC. CMS提供了<code>-XX:CMSInitiatingOccupancyFraction</code>参数, 可以指定当老年代的使用空间百分比达到多少时, 启动CMS GC, <strong>这个参数一定要结合系统的运行情况去设置, 不然, 设置的高了就会增加Full GC的风险, 设置的低了, 就会导致频繁的CMS GC</strong>,</li> <li><strong>内存碎片</strong>, 由于CMS使用的是标记清除算法, 那么不可避免的就会造成内存碎片, 那么, 一旦出现明明老年代的空间大小足够但是却分配失败的问题, 就会导致出现Full GC. CMS提供了<code>-XX:+UseCMSCompactAtFullCollection</code>参数, 在顶不住要进行Full GC时开启内存碎片整理, 同时, 也提供了<code>-XX:CMSFullGCsBeforeCompaction</code>参数, 即指定每隔多少次不压缩的Full GC之后, 再执行一次带压缩锁的Full GC,</li> <li>优化jvm参数配置有些复杂.</li></ol> <h5 id="可配置参数-4"><a href="#可配置参数-4" class="header-anchor">#</a> 可配置参数</h5> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td><code>-XX:+UseConcMarkSweepGC</code></td> <td>指定老年代使用CMS 收集器, 同时, 新生代会默认选用ParNew 收集器</td></tr> <tr><td><code>-XX:ParallelCMSThreads=n</code></td> <td>CMS GC工作时的并行线程数, 默认为(CPU核心数+3)/4</td></tr> <tr><td><code>-XX:CMSInitiatingOccupancyFraction=n</code></td> <td>默认92, 指定CMS在老年代内存占用率达到多少时开始GC</td></tr> <tr><td><code>-XX:+UseCMSInitiatingOccupancyOnly</code></td> <td>指定CMS只使用设定的回收阈值, 如果不配置该参数的话, CMS只会在第一次GC时使用设定阈值, 之后会自动调整</td></tr> <tr><td><code>-XX:+UseCMSCompactAtFullCollection</code></td> <td>指定在进行Full GC时进行内存压缩</td></tr> <tr><td><code>-XX:CMSFullGCsBeforeCompaction=n</code></td> <td>默认0, 指定每隔n次不压缩的Full GC之后, 执行一次带压缩的Full GC</td></tr> <tr><td><code>-XX:+CMSParallelInitialMarkEnabled</code></td> <td>开启初始标记阶段的并行执行, 默认开启</td></tr> <tr><td><code>-XX:CMSScheduleRemarkEdenSizeThreshold=n</code></td> <td>默认2M, 当Eden区的使用空间大于配置值时, 不会开启可中断的预清理操作</td></tr> <tr><td><code>-XX:CMSScheduleRemarkEdenPenetration=n</code></td> <td>默认50%, 当Eden区的使用率大于等于配置值时, 不会开启可中断的预清理操作</td></tr> <tr><td><code>-XX:CMSMaxAbortablePrecleanLoops=n</code></td> <td>默认0, 那么当可中断预清理执行了n次之后, 会退出该阶段</td></tr> <tr><td><code>-XX:CMSMaxAbortablePrecleanTime=n</code></td> <td>默认5s, 当可中断预清理的执行时间超过了这个值后, 会退出该阶段</td></tr> <tr><td><code>-XX:+CMSScavengeBeforeRemark</code></td> <td>开启这个参数, 会在进入重标记阶段之前强制触发一次young gc</td></tr> <tr><td><code>-XX:+ExplicitGCInvokesConcurrent</code></td> <td>开启这个参数, System.gc()不会触发STW的Full GC, 而是触发一次并发的GC周期</td></tr> <tr><td><code>-XX:+ExplicitGCInvokesConcurrentAndUnloadsClasses</code></td> <td>和上一个参数差不多, 只不过多了一个卸载class的功能</td></tr></tbody></table> <h3 id="基于region的垃圾收集器"><a href="#基于region的垃圾收集器" class="header-anchor">#</a> 基于region的垃圾收集器</h3> <h4 id="region"><a href="#region" class="header-anchor">#</a> region</h4> <p>简述下region的概念, 上文中提到的几种垃圾收集器和下面要讲到的G1, 都是基于分代回收的, 区别是,</p> <ol><li><p>CMS 等收集器, 是将整个堆连续分成了新生代(Eden, S0, S1), 老年代, <s>永久代(如果有的话)</s>, 如下图所示,</p> <p><img src="data:image/png;base64,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" alt="heap-structure"></p></li> <li><p>G1 收集器, 是将整个堆分成了多个region, 每个region都可以是Eden, Survivor, Old, Humongous区(分配大对象的region, 属于Old), 所以, 不同的Eden区可能是不连续的, 如下图所示,</p> <p><img src="data:image/png;base64,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" alt="g1-heap-structure"></p></li></ol> <h4 id="g1-jdk-9-收集器"><a href="#g1-jdk-9-收集器" class="header-anchor">#</a> G1(jdk 9)收集器</h4> <p>G1 收集器虽然同样基于分代回收的策略, 但是它和CMS 等收集器不同, 它是同时在新生代和老年代使用.</p> <h5 id="g1垃圾收集器的工作原理"><a href="#g1垃圾收集器的工作原理" class="header-anchor">#</a> G1垃圾收集器的工作原理</h5> <p>G1提供了两种GC模式,</p> <ol><li>一种是Young GC, 回收新生代的region空间,</li> <li>一种是Mixed GC, 回收新生代的region空间和部分老年代的region空间,</li> <li>一旦Mixed GC跟不上对象分配的速度, 导致没有空的region来完成Mixed GC之后, 就会退化为Serial Old 收集器(Full GC)来对整堆进行一次回收.</li></ol> <p>从全局看, G1的执行应该分为两部分,</p> <ul><li>全局并发标记(global concurrent marking)</li> <li>拷贝存活对象(evacuation)</li></ul> <p>全局并发标记(global concurrent marking)是基于SATB形式的并发标记, 它具体分为以下几个步骤,</p> <ol><li><strong>初始标记(initial marking)</strong>, STW, 扫描GC Root, 标记所有可从GC Root<strong>直接到达</strong>的对象, G1使用外部的bitmap来记录Mark信息, 而不使用对象头的Mark Word中的mark bit, 并且, 初始标记阶段借用了young gc的暂停, 因此它没有额外的暂停,</li> <li><strong>并发标记(concurrent marking)</strong>, 并发阶段, 从初始阶段标记过的对象出发, 遍历整个堆的对象, 并标记可达对象, 直到扫描结束, 在这个过程中, 还会扫描SATB write barrier所记录下的引用,</li> <li><strong>重新标记(final marking, 在实现中也叫remarking)</strong>, STW, 在完成并发标记后, 每个Java线程还会有一些SATB write barrier所记录下的引用尚未处理, 这个阶段就是处理这些引用的, 并且, 还会进行弱引用处理,</li> <li><strong>并发清除(cleanup)</strong>, STW, 清点和重置标记状态, 这个阶段会标记bitmap中统计的每个region里被标记存活的对象有多少, 如果发现某个region中没有活对象了, 则会将其整体回收到可分配的region列表,</li></ol> <p>拷贝存活对象(evacuation)阶段是全暂停(STW)的, 它负责把一部分region里边的活对象copy到空的region中, 然后回收原本的空间, Evacuation阶段可以自由选择多个region来独立收集, 这些region就构成了收集集合(Collection Set, 简称CSet), 是通过per region Remembered set(简称RSet)实现的, 这也是基于region的垃圾收集器的特征,</p> <p>在选定CSet之后, evacuation就跟Parallel Scavenge收集器有点类似了, 通过并行copying算法, 把CSet集合中的每个region的活对象copy到新的region中, 整个过程是STW的,</p> <ol><li>Young GC, 选定所有新生代的region进行GC, 所以可以通过控制新生代的region个数来控制young gc的开销,</li> <li>Mixed GC, 选定所有的新生代的region和部分在global concurrent marking阶段统计得出的收益最高的若干老年代的region, 在用户指定的开销范围目标内尽可能选择收益高的region进行GC,</li> <li>这就就能看到, 新生代的region一定是在CSet中的, 所以G1没有维护从新生代region出发的引用涉及到的RSet的更新.</li></ol> <p>分代式G1的工作流程就是在young gc和mixed gc之间视情况来切换, 背后定期会做全局并发标记(global concurrent marking), 而初始标记(initial marking)一般都是搭在young gc时做的, 当全局并发标记正在工作时, G1不会选择做mixed GC, 反之如果有mixed GC正在进行中, G1也不会启动initial marking.</p> <p>注意, G1 GC下的System.gc()默认还是Full GC, 即会导致STW, 可以通过指定<code>-XX:+ExplicitGCInvokesConcurrent</code>来启用并发的GC来执行System.gc(), <strong>此时System.gc()的作用是, 强制开启一次全局并发标记(global concurrent marking)</strong>.</p> <p>到目前为止, 可以看到, G1 收集器只有全局并发标记(global concurrent marking)阶段是并发的, 其他三个阶段都是会STW的, 那为什么还说G1是低延迟的GC实现呢?</p> <p>重点就在于, G1虽然mark了整个堆, 但是并不会回收整个堆的垃圾对象, 而是会选择收益最高的region进行收集, 所以, 每次evacuation阶段的STW就是可控的了, 而且, 可以通过<code>-XX:MaxGCPauseMillis</code>命令来设置目标预期(但是请不要设置的太低, 不然G1跟不上目标就会导致大量的垃圾堆积).</p> <h5 id="优点-2"><a href="#优点-2" class="header-anchor">#</a> 优点</h5> <ol><li>G1通过将内存分成多个region的形式, 尽量避免了内存碎片的问题,</li> <li>可以通过设置预期停顿时间来控制GC停顿时间(尽量不要设置太低), 尽量避免了单次GC停顿时间长的问题,</li> <li>G1在回收内存后, 会同时做合并空闲内存的操作,</li> <li>G1可以在新生代, 老年代使用,</li> <li>在服务器CPU多核, 内存比较大的应用下, 推荐使用G1.</li></ol> <h5 id="不足-2"><a href="#不足-2" class="header-anchor">#</a> 不足</h5> <ol><li>G1占用的内存会更大一些, 因为需要额外的空间存储CSet, Rset, cart table等信息,</li> <li>单个region的很难指定, 太小会导致分配大对象是很难找到连续空间, 太大又可能会导致空间的浪费.</li></ol> <h5 id="可配置参数-5"><a href="#可配置参数-5" class="header-anchor">#</a> 可配置参数</h5> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td><code>-XX:+UseG1GC</code></td> <td>指定使用G1 收集器</td></tr> <tr><td><code>-XX:MaxGCPauseMillis</code></td> <td>指定G1收集过程的目标停顿时间, 默认值是200ms, 不过这不是硬性条件, 而是一个期望值</td></tr> <tr><td><code>-XX:InitiatingHeapOccupancyPercent=n</code></td> <td>默认45, 指定当Java堆的占用率达到参数值时, 开始并发标记阶段</td></tr> <tr><td><code>-XX:G1HeapRegionSize</code></td> <td>指定一个Region的大小, 取值范围从1M到32M, 且是2的指数, 如果不设定,那么G1会根据Heap大小自动决定</td></tr></tbody></table> <h3 id="低延时垃圾收集器"><a href="#低延时垃圾收集器" class="header-anchor">#</a> 低延时垃圾收集器</h3> <h4 id="zgc-jdk-11-收集器"><a href="#zgc-jdk-11-收集器" class="header-anchor">#</a> ZGC(jdk 11)收集器</h4> <p>ZGC 是jdk 11中推出的一款低延时垃圾收集器, 它的目标包括,</p> <ul><li>停顿时间不超过10ms,</li> <li>停顿时间不会随着堆的大小或活跃对象的大小而增加,</li> <li>支持8MB~4TB级别的堆(未来可能支持16TB).</li></ul> <p>从设计目标, 我们可以看出, ZGC适用于大内存低延迟服务的内存管理及回收.</p> <h5 id="zgc-垃圾收集器的工作原理"><a href="#zgc-垃圾收集器的工作原理" class="header-anchor">#</a> ZGC 垃圾收集器的工作原理</h5> <p><s>比较复杂, 还没看明白, 所以暂时简单写几个点.</s></p> <ol><li>ZGC也和G1类似, 是基于复制算法实现的, 不过ZGC对该算法做了改进, 这使得它在标记, 转移, 重定位阶段几乎都是并发的, 这也是它可以实现停顿小于10ms的主要原因,</li> <li>ZGC通过着色指针和读屏障技术，解决了转移过程中准确访问对象的问题，实现了真正的并发转移,
<ol><li>着色指针, 一种将信息存储到指针的技术,</li> <li>读屏障, 就是在用户线程读取堆中对象之前会优先执行一段代码.</li></ol></li></ol> <p>ZGC大致分为以下几个阶段,</p> <ol><li>初始标记, STW,</li> <li>并发标记/对象重定位,</li> <li>再标记, STW,</li> <li>并发转移准备,</li> <li>初始转移, STW,</li> <li>并发转移.</li></ol> <h5 id="优点-3"><a href="#优点-3" class="header-anchor">#</a> 优点</h5> <p>目前最理想的垃圾收集器(<s>如果能用的话</s>).</p> <h5 id="不足-3"><a href="#不足-3" class="header-anchor">#</a> 不足</h5> <ol><li>由于ZGC在GC过程中, 基本上是并发的, 所有它调优的主要目的就是, 如何保证在GC完成之前, 新对象不会将堆占满,</li> <li>最低支持版本为jdk11, 更低版本jdk无法使用.</li></ol> <h5 id="可配置参数-6"><a href="#可配置参数-6" class="header-anchor">#</a> 可配置参数</h5> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td><code>-XX:+UseZGC</code></td> <td>使用ZGC</td></tr> <tr><td><code>-XX:ZCollectionInterval</code></td> <td>ZGC发生的最小时间间隔</td></tr> <tr><td><code>-XX:ZAllocationSpikeTolerance</code></td> <td>ZGC触发自适应算法的修正系数, 数值越大, 越早的触发ZGC, 默认2</td></tr> <tr><td><code>-XX:+ZProactive</code></td> <td>是否启用主动回收, 默认开启</td></tr> <tr><td><code>-XX:ConcGCThreads</code></td> <td>并发回收垃圾的线程, 调大后GC变快, 但会占用程序运行时的CPU资源, 吞吐会受到影响, 默认是总核数的12.5%, 8核CPU默认是1</td></tr></tbody></table> <h5 id="zgc重要配置参数-参考-美团技术团队"><a href="#zgc重要配置参数-参考-美团技术团队" class="header-anchor">#</a> ZGC重要配置参数(参考, 美团技术团队)</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 堆的最大, 最小内存</span>
<span class="token operator">-</span><span class="token class-name">Xms10G</span> <span class="token operator">-</span><span class="token class-name">Xmx10G</span>
<span class="token comment">// 设置CodeCache的大小, JIT编译的代码都放在CodeCache中, 一般服务64m或128m就已经足够</span>
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">ReservedCodeCacheSize</span><span class="token operator">=</span><span class="token number">256</span>m <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">InitialCodeCacheSize</span><span class="token operator">=</span><span class="token number">256</span>m
<span class="token comment">// 启用ZGC</span>
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UnlockExperimentalVMOptions</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseZGC</span>
<span class="token comment">// 并发回收垃圾的线程, 默认是总核数的12.5%, 8核CPU默认是1. 调大后GC变快, 但会占用程序运行时的CPU资源, 吞吐会受到影响</span>
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">ConcGCThreads</span><span class="token operator">=</span><span class="token number">2</span> 
<span class="token comment">// STW阶段使用线程数, 默认是总核数的60%</span>
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">ParallelGCThreads</span><span class="token operator">=</span><span class="token number">6</span>
<span class="token comment">// ZGC发生的最小时间间隔, 单位秒</span>
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">ZCollectionInterval</span><span class="token operator">=</span><span class="token number">120</span>
<span class="token comment">// ZGC触发自适应算法的修正系数, 默认2, 数值越大, 越早的触发ZGC</span>
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">ZAllocationSpikeTolerance</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token comment">// 是否启用主动回收, 默认开启, 这里的配置表示关闭</span>
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UnlockDiagnosticVMOptions</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">-</span><span class="token class-name">ZProactive</span>
</code></pre></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <h3 id="gc-名词解释"><a href="#gc-名词解释" class="header-anchor">#</a> GC 名词解释</h3> <h4 id="young-gc-minior-gc"><a href="#young-gc-minior-gc" class="header-anchor">#</a> Young GC(Minior GC)</h4> <p>这个没啥疑问, 对新生代区域的GC.</p> <h4 id="major-gc"><a href="#major-gc" class="header-anchor">#</a> Major GC</h4> <p>除CMS, G1 收集器之外的其他几种收集器, 在执行Major GC时, 会同时清理新生代和老年代, 所以这个时候, Major GC就等价于Full GC.</p> <h4 id="old-gc"><a href="#old-gc" class="header-anchor">#</a> Old GC</h4> <p>只回收老年代, 不会回收新生代, 只有CMS的concurrent collection是这个模式.</p> <h4 id="mixed-gc"><a href="#mixed-gc" class="header-anchor">#</a> Mixed GC</h4> <p>回收整个新生代和部分老年代, 只有G1有这个模式.</p> <h4 id="full-gc"><a href="#full-gc" class="header-anchor">#</a> Full GC</h4> <p>Full GC就是全堆回收, 回收新生代, 老年代, <s>永久代(如果有的话)</s>, 元空间,</p> <p>那对于CMS 收集器来说, 一旦Old GC之后也无法分配对象, 就会退化为备选方案, 使用Serial Old 收集器进行Full GC.</p> <h4 id="三色扫描"><a href="#三色扫描" class="header-anchor">#</a> 三色扫描</h4> <p>GC时, 会将对象分为三类, 即所谓的black对象, grey对象, white对象,</p> <ol><li>black对象指的是, 自身已经被标记到, 并且其引用的所有对象都已经被标记的对象,</li> <li>grey对象指的是, 自身已经被标记到, 但是其所有引用对象还没有被标记完成的对象,</li> <li>white对象指的是, 还没有被标记到的对象.</li></ol> <h4 id="remembered-set"><a href="#remembered-set" class="header-anchor">#</a> Remembered Set</h4> <p>一般简称RSet, 是一个抽象概念.</p> <h4 id="cart-table"><a href="#cart-table" class="header-anchor">#</a> cart table</h4> <p>cart table实际上就是RSet的一种实现方式, 如果要对应下面的术语, 那一般的card table实现是记录的当前区域指向其他区域的一个记录, 所以应该算是一种Point out的形式.</p> <p>CMS将老年代分成了大小为512byte的块, card table的每一个元素就对应着一个块, 当并发标记时, 如果某个对象的引用发生了变化, 就会将该块标记成dirty card, 这样, 在并发预清理阶段, 就会重新扫描dirty card, 然后将该区域内对象引用的对象标记成可达的.</p> <h5 id="point-into"><a href="#point-into" class="header-anchor">#</a> Point into</h5> <p>G1和CMS类似, 它也有一个覆盖整个heap的RSet, 区别在于它为每个region都记录了一个RSet, 那这个RSet实际上是记录的其他region到当前region的card, 所以这是一种Point into的RSet.</p> <h5 id="point-out"><a href="#point-out" class="header-anchor">#</a> Point out</h5> <p>而且, G1还维护了一个Point out的RSet, 这个RSet记录的是指向当前region的那些region的指针的的card位置, 所以, G1实际上是在Point out的card table之上又维护了一层结构构成了Point into的card table, 也就类似说, G1的card table是一个hash table, key是别的region的起始位置, value是当前region的card table的index.</p> <h4 id="write-barrier"><a href="#write-barrier" class="header-anchor">#</a> write barrier</h4> <p>写屏障.</p> <p>由于在并发标记阶段, GC线程和用户线程是同时执行的, 所以很有可能出现对象的引用发生变化的情况, 那么一般有两种处理方式, 读屏障和写屏障, 一般考虑到Java对象都是读多写少的, 所以CMS和G1都是采用的写屏障, 目前只有ZGC采用的读屏障,</p> <p>而且G1和CMS又有些不同, 因为G1实际上使用了两种写屏障, 写前屏障(pre write barrier)和写后屏障(post-write barrier), 而CMS实际上只使用了写后屏障(post-write barrier).</p> <h4 id="logging-write-barrier"><a href="#logging-write-barrier" class="header-anchor">#</a> logging write barrier</h4> <p>写屏障日志, G1 收集器使用.</p> <p>上面有提到, G1实际上使用了两种写屏障, 那如果都在用户线程中去处理的话, 不可避免的就会影响用户线程的速度, 所以G1将一些原本应该在屏障里执行的动作写到一个队列里, 通过其他的线程异步执行, 这个队列的概念其实就是logging write barrier,</p> <p>比如说, 以SATB write barrier为例, 每个Java线程有一个独立的, 定长的SATBMarkQueue, 用户线程在barrier里只把old value压入该队列中. 一个队列满了之后, 它就会被加到全局的SATB队列集合SATBMarkQueueSet里等待处理, 然后给对应的Java线程换一个新的, 干净的队列继续执行下去,</p> <p>然后, 在并发标记(concurrent marker)阶段会定期检查全局SATB队列集合的大小, 当全局集合中队列数量超过一定阈值后, concurrent marker就会处理集合里的所有队列, 把队列里记录的每个oop都标记上, 并将其引用字段压到标记栈(marking stack)上等后面做进一步标记.</p> <h4 id="stab"><a href="#stab" class="header-anchor">#</a> STAB</h4> <p>snapshot at the beginning, G1 收集器特有的东西, 即在开始GC时, G1会为当前堆中的存活对象做一个快照, 然后将GC过程中新分配的对象也当成是存活的.</p> <h4 id="incremental-update-增量更新"><a href="#incremental-update-增量更新" class="header-anchor">#</a> <s>Incremental update(增量更新)</s></h4> <p>没记错的话, 这个应该是CMS 收集器已经废弃的东西.</p> <h3 id="gc调优策略"><a href="#gc调优策略" class="header-anchor">#</a> GC调优策略</h3> <p>我认为, GC调优的目的, 就是降低Full GC发生的频率, 因为young gc的停顿时间实际上是相对比较短的, 那同时, 也可以增大内存来降低young gc的次数,</p> <p>当然, 针对不同的垃圾收集器, 也会有相应的调优参数.</p> <h4 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 统计内存分配速率, GC耗时, GC次数</span>
jstat <span class="token operator">-</span>gc <span class="token generics"><span class="token punctuation">&lt;</span>pid<span class="token punctuation">&gt;</span></span> <span class="token operator">&lt;</span>统计间隔时间<span class="token operator">&gt;</span>  <span class="token operator">&lt;</span>统计次数<span class="token operator">&gt;</span>

<span class="token comment">// 命令行输出类名、类数量数量，类占用内存大小，</span>
<span class="token comment">// 按照类占用内存大小降序排列</span>
jmap <span class="token operator">-</span>histo <span class="token generics"><span class="token punctuation">&lt;</span>pid<span class="token punctuation">&gt;</span></span>

<span class="token comment">// 生成堆内存转储快照，在当前目录下导出dump.hrpof的二进制文件，</span>
<span class="token comment">// 可以用eclipse的MAT图形化工具分析</span>
jmap <span class="token operator">-</span>dump<span class="token operator">:</span>live<span class="token punctuation">,</span>format<span class="token operator">=</span>b<span class="token punctuation">,</span>file<span class="token operator">=</span>dump<span class="token punctuation">.</span>hprof <span class="token generics"><span class="token punctuation">&lt;</span>pid<span class="token punctuation">&gt;</span></span>

<span class="token comment">// 查看正在运行的java应用的扩展参数, 包括java system属性和jvm命令行参数</span>
jinfo <span class="token generics"><span class="token punctuation">&lt;</span>pid<span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="常用配置参数"><a href="#常用配置参数" class="header-anchor">#</a> 常用配置参数</h4> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td><code>-Xmx, -Xms, -Xmn</code></td> <td>堆空间的最大值, 最小值; 新生代的大小</td></tr> <tr><td><code>-Xss</code></td> <td>线程栈的大小, 默认是1M</td></tr> <tr><td><code>-XX:SurvivorRatio=n</code></td> <td>新生代中Eden和Survivor的比例, 默认是8</td></tr> <tr><td><code>-XX:MaxTenuringThreshold=n</code></td> <td>对象从新生代晋升到老年代的年龄阈值, 默认是15, 一般使用默认值即可</td></tr> <tr><td><code>-XX:+UseCompressedOops</code></td> <td>开启指针压缩, 默认开启</td></tr> <tr><td><code>-XX:-UseCompressedOops</code></td> <td>关闭指针压缩</td></tr> <tr><td><code>-XX:+DisableExplicitGC</code></td> <td>忽略显式调用的System.gc()命令</td></tr> <tr><td><code>-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps</code></td> <td>打印GC日志</td></tr></tbody></table> <h4 id="常用分析工具"><a href="#常用分析工具" class="header-anchor">#</a> 常用分析工具</h4> <ul><li>jdk自带的监控分析工具Visual VM,</li> <li>GC 日志分析: GCViewer, gceasy,</li> <li>GC 参数检查和优化: http://xxfox.perfma.com/.</li></ul> <h3 id="结束语"><a href="#结束语" class="header-anchor">#</a> 结束语</h3> <ol><li>没有最合适的收集器, 只有与业务最匹配的收集器, 不过, 一般情况下,
<ol><li>如果考虑吞吐量优先, 可使用Parallel Scavenge+Parallel Old的组合,</li> <li>如果考虑低停顿时间, 可使用ParNew+CMS的组合,</li> <li>G1 解决了 CMS 的一些问题, 如果追求最短停顿时间, 并且也不想让吞吐量降低很多, 可以考虑使用,</li></ol></li> <li>同样, 也没有最合适的调优参数, 所以的收集器配置参数都得结合实际的系统进行调整, 一句话, 乱调优不如不调优,</li> <li>现在大型的分布式系统基本都是高并发的, 那为了提升用户的体验, 低延时的垃圾处理器应该是未来,</li> <li>本文实际上是较为浅显的讲述了一下关于JVM的基础内容, 基本上没有深入, 因为有很多内容, 其实现是比较复杂的, 比如说CMS, G1, ZGC更细节的实现原理, 比如不同收集器对于RSet, cart table的实现, 写屏障, 读屏障, TLAB(栈上分配)等等,</li> <li>不过, 作为一篇简单了解JVM的文章还是勉强可以的.</li></ol> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li>Java 虚拟机规范(Java SE 8)</li> <li>深入理解 Java 虚拟机</li> <li><a href="https://mp.weixin.qq.com/s/_AKQs-xXDHlk84HbwKUzOw" target="_blank" rel="noopener noreferrer">几种垃圾收集器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/littleLord/p/5380624.html" target="_blank" rel="noopener noreferrer">详解 CMS 垃圾回收机制<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://ifeve.com/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3g1%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8" target="_blank" rel="noopener noreferrer">深入理解 G1 垃圾收集器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://tech.meituan.com/2016/09/23/g1.html" target="_blank" rel="noopener noreferrer">Java Hotspot G1 GC 的一些关键技术<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://tech.meituan.com/2020/08/06/new-zgc-practice-in-meituan.html" target="_blank" rel="noopener noreferrer">新一代垃圾回收器 ZGC 的探索与实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://hllvm-group.iteye.com/group/topic/38223#post-248757" target="_blank" rel="noopener noreferrer">并发垃圾收集器 CMS 为什么没有采用标记-整理算法来实现?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://hllvm-group.iteye.com/group/topic/44381" target="_blank" rel="noopener noreferrer">HotSpot VM 请教G1算法的原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/41922036/answer/93079526" target="_blank" rel="noopener noreferrer">Major GC和Full GC的区别是什么? 触发条件呢?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.oracle.com/webfolder/technetwork/tutorials/obe/java/G1GettingStarted/index.html" target="_blank" rel="noopener noreferrer">Getting Started with the G1 Garbage Collector<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/53613423/answer/135743258" target="_blank" rel="noopener noreferrer">Java 的 GC 为什么要分代<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="附录"><a href="#附录" class="header-anchor">#</a> 附录</h2> <h3 id="cms-gc-日志分析"><a href="#cms-gc-日志分析" class="header-anchor">#</a> CMS GC 日志分析</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 可以看到,首先执行了两次young gc, 原因是内存分配失败, gc后新生代从279397K降到了34336K, 整个堆区已用空间从279397K降到了266804K, 耗时很短, 每次都是100ms左右</span>
<span class="token number">0.240</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span> <span class="token number">0.240</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">ParNew</span><span class="token operator">:</span> <span class="token number">279397</span>K<span class="token operator">-&gt;</span><span class="token function">34336K</span><span class="token punctuation">(</span><span class="token number">314560</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1043962</span> secs<span class="token punctuation">]</span> <span class="token number">279397</span>K<span class="token operator">-&gt;</span><span class="token function">266804K</span><span class="token punctuation">(</span><span class="token number">1013632</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1044371</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.12</span> sys<span class="token operator">=</span><span class="token number">0.44</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.11</span> secs<span class="token punctuation">]</span> 
<span class="token number">0.378</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span> <span class="token number">0.378</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">ParNew</span><span class="token operator">:</span> <span class="token number">313162</span>K<span class="token operator">-&gt;</span><span class="token function">34066K</span><span class="token punctuation">(</span><span class="token number">314560</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1220106</span> secs<span class="token punctuation">]</span> <span class="token number">545630</span>K<span class="token operator">-&gt;</span><span class="token function">545523K</span><span class="token punctuation">(</span><span class="token number">1013632</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1220397</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.14</span> sys<span class="token operator">=</span><span class="token number">0.61</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.12</span> secs<span class="token punctuation">]</span> 

<span class="token comment">// 1. 初始标记阶段, STW, 这个阶段会标记从GC Root可以直连的对象, 可以看到, 整个老年代有699072K, 在其达到511456K时, 触发了CMS,</span>
<span class="token number">0.500</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span>CMS <span class="token class-name">Initial</span> <span class="token class-name">Mark</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">1</span> CMS<span class="token operator">-</span>initial<span class="token operator">-</span>mark<span class="token operator">:</span> <span class="token function">511456K</span><span class="token punctuation">(</span><span class="token number">699072</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token function">546547K</span><span class="token punctuation">(</span><span class="token number">1013632</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0004818</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
  
<span class="token comment">// 2.1. 并发标记阶段开始, 并发执行, 上一阶段被暂停的线程都开始运行, 接下来, GC线程会从上一阶段被标记的对象出发, 然后标记所有可达的对象,</span>
<span class="token number">0.501</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>mark<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 2.2. 并发标记结束, CPU耗时3ms</span>
<span class="token number">0.503</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>mark<span class="token operator">:</span> <span class="token number">0.003</span><span class="token operator">/</span><span class="token number">0.003</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
  
<span class="token comment">// 3.1. 预清理阶段开始, 并发执行, 这一阶段会查找在上一阶段执行过程中, 从新生代晋升或者新分配或者被更新的对象, 并发的扫描这些对象, 这一阶段的目的主要是为了降低重标记阶段STW的耗时,</span>
<span class="token number">0.503</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>preclean<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 3.2. 预清理阶段结束, CPU耗时1ms</span>
<span class="token number">0.504</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>preclean<span class="token operator">:</span> <span class="token number">0.001</span><span class="token operator">/</span><span class="token number">0.001</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.01</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.01</span> secs<span class="token punctuation">]</span> 
  
<span class="token comment">// 4. 可中断预清理阶段开始</span>
<span class="token number">0.504</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>abortable<span class="token operator">-</span>preclean<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 这里, 我们可以猜测, 是因为可中断预清理判断到条件满足, 可以执行一次young gc, 所以这里才又发生了一次young gc, 但是可以看到, 新生代从312954K到312954K完全没有回收空间, 这说明,可能是老年代空间不足, 所以下面直接触发了一次full gc</span>
<span class="token number">0.534</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span> <span class="token number">0.534</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">ParNew</span><span class="token operator">:</span> <span class="token number">312954</span>K<span class="token operator">-&gt;</span><span class="token function">312954K</span><span class="token punctuation">(</span><span class="token number">314560</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0000247</span> secs<span class="token punctuation">]</span><span class="token number">0.534</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS0<span class="token punctuation">.</span><span class="token number">534</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>abortable<span class="token operator">-</span>preclean<span class="token operator">:</span> <span class="token number">0.001</span><span class="token operator">/</span><span class="token number">0.030</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.03</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.02</span> secs<span class="token punctuation">]</span> 
<span class="token comment">// 可以看到, 这里的错误是concurrent mode failure, 应该是因为内存碎片导致的, 那这里就会启用CMS的备选方案, 即使用Serial Old收集器, 这也就导致发生了Full GC, STW, 老年代从511456K增加到了698843K(之所以不降反升, 是因为我的测试用例里没有释放对象的引用, 所以老年代一定是持续增长的), 耗时100ms+, </span>
 <span class="token punctuation">(</span>concurrent mode failure<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">511456</span>K<span class="token operator">-&gt;</span><span class="token function">698843K</span><span class="token punctuation">(</span><span class="token number">699072</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1978149</span> secs<span class="token punctuation">]</span> <span class="token number">824411</span>K<span class="token operator">-&gt;</span><span class="token function">823778K</span><span class="token punctuation">(</span><span class="token number">1013632</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name">Metaspace</span><span class="token operator">:</span> <span class="token number">3094</span>K<span class="token operator">-&gt;</span><span class="token function">3094K</span><span class="token punctuation">(</span><span class="token number">1056768</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.1979056</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.14</span> sys<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.20</span> secs<span class="token punctuation">]</span> 
<span class="token comment">// 又一次初始标记开始</span>
<span class="token number">2.735</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span>CMS <span class="token class-name">Initial</span> <span class="token class-name">Mark</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">1</span> CMS<span class="token operator">-</span>initial<span class="token operator">-</span>mark<span class="token operator">:</span> <span class="token function">698843K</span><span class="token punctuation">(</span><span class="token number">699072</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token function">942051K</span><span class="token punctuation">(</span><span class="token number">1013632</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0005477</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
<span class="token comment">// 并发标记阶段开始</span>
<span class="token number">2.736</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>mark<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 并发标记耗时3ms</span>
<span class="token number">2.738</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>mark<span class="token operator">:</span> <span class="token number">0.003</span><span class="token operator">/</span><span class="token number">0.003</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
<span class="token comment">// 预清理阶段开始</span>
<span class="token number">2.738</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>preclean<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 预清理阶段耗时2ms</span>
<span class="token number">2.741</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>preclean<span class="token operator">:</span> <span class="token number">0.002</span><span class="token operator">/</span><span class="token number">0.002</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
<span class="token comment">// 可中断预清理阶段开始</span>
<span class="token number">2.741</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>abortable<span class="token operator">-</span>preclean<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 可中断预清理阶段耗时小于1ms</span>
<span class="token number">2.741</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>abortable<span class="token operator">-</span>preclean<span class="token operator">:</span> <span class="token number">0.000</span><span class="token operator">/</span><span class="token number">0.000</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
  
<span class="token comment">// 5. 重标记阶段, STW, 多线程执行, 这里会从根及其被引用的对象开始, 重新扫描堆中残留的被更新的对象, remark一共耗时1ms</span>
<span class="token number">2.741</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span>CMS <span class="token class-name">Final</span> <span class="token class-name">Remark</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>YG occupancy<span class="token operator">:</span> <span class="token number">243207</span> <span class="token class-name">K</span> <span class="token punctuation">(</span><span class="token number">314560</span> <span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token number">2.741</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">Rescan</span> <span class="token punctuation">(</span>parallel<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token number">0.0005761</span> secs<span class="token punctuation">]</span><span class="token number">2.742</span><span class="token operator">:</span> <span class="token punctuation">[</span>weak refs processing<span class="token punctuation">,</span> <span class="token number">0.0000109</span> secs<span class="token punctuation">]</span><span class="token number">2.742</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">class</span> unloading<span class="token punctuation">,</span> <span class="token number">0.0003480</span> secs<span class="token punctuation">]</span><span class="token number">2.742</span><span class="token operator">:</span> <span class="token punctuation">[</span>scrub symbol table<span class="token punctuation">,</span> <span class="token number">0.0005884</span> secs<span class="token punctuation">]</span><span class="token number">2.743</span><span class="token operator">:</span> <span class="token punctuation">[</span>scrub string table<span class="token punctuation">,</span> <span class="token number">0.0002238</span> secs<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span> CMS<span class="token operator">-</span>remark<span class="token operator">:</span> <span class="token function">698843K</span><span class="token punctuation">(</span><span class="token number">699072</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token function">942051K</span><span class="token punctuation">(</span><span class="token number">1013632</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0018009</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.01</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
  
<span class="token comment">// 6.1. 并发清理阶段, 并发执行, 这一阶段就会清理无用对象,</span>
<span class="token number">2.743</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>sweep<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 6.2. 并发清理阶段结束, 耗时小于1ms</span>
<span class="token number">2.743</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>sweep<span class="token operator">:</span> <span class="token number">0.000</span><span class="token operator">/</span><span class="token number">0.000</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
  
<span class="token comment">// 7.1. 并发重置阶段开始, 并发执行, 在本阶段, 会重新初始化CMS内部数据结构, 以备下一轮GC使用,</span>
<span class="token number">2.743</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>reset<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token comment">// 7.2. 并发重置阶段结束, 耗时1ms</span>
<span class="token number">2.744</span><span class="token operator">:</span> <span class="token punctuation">[</span>CMS<span class="token operator">-</span>concurrent<span class="token operator">-</span>reset<span class="token operator">:</span> <span class="token number">0.001</span><span class="token operator">/</span><span class="token number">0.001</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
  
<span class="token comment">// 到这里, 一次完整的CMS gc就执行结束了</span>
<span class="token class-name">Heap</span>
 par <span class="token keyword">new</span> generation   total <span class="token number">314560</span>K<span class="token punctuation">,</span> used <span class="token number">248800</span>K <span class="token punctuation">[</span><span class="token number">0x0000000780000000</span><span class="token punctuation">,</span> <span class="token number">0x0000000795550000</span><span class="token punctuation">,</span> <span class="token number">0x0000000795550000</span><span class="token punctuation">)</span>
  eden space <span class="token number">279616</span>K<span class="token punctuation">,</span>  <span class="token number">88</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x0000000780000000</span><span class="token punctuation">,</span> <span class="token number">0x000000078f2f8140</span><span class="token punctuation">,</span> <span class="token number">0x0000000791110000</span><span class="token punctuation">)</span>
  from space <span class="token number">34944</span>K<span class="token punctuation">,</span>   <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x0000000791110000</span><span class="token punctuation">,</span> <span class="token number">0x0000000791110000</span><span class="token punctuation">,</span> <span class="token number">0x0000000793330000</span><span class="token punctuation">)</span>
  <span class="token keyword">to</span>   <span class="token namespace">space</span> <span class="token number">34944</span>K<span class="token punctuation">,</span>   <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x0000000793330000</span><span class="token punctuation">,</span> <span class="token number">0x0000000793330000</span><span class="token punctuation">,</span> <span class="token number">0x0000000795550000</span><span class="token punctuation">)</span>
 concurrent mark<span class="token operator">-</span>sweep generation total <span class="token number">699072</span>K<span class="token punctuation">,</span> used <span class="token number">698840</span>K <span class="token punctuation">[</span><span class="token number">0x0000000795550000</span><span class="token punctuation">,</span> <span class="token number">0x00000007c0000000</span><span class="token punctuation">,</span> <span class="token number">0x00000007c0000000</span><span class="token punctuation">)</span>
 <span class="token class-name">Metaspace</span>       used <span class="token number">3613</span>K<span class="token punctuation">,</span> capacity <span class="token number">4540</span>K<span class="token punctuation">,</span> committed <span class="token number">4864</span>K<span class="token punctuation">,</span> reserved <span class="token number">1056768</span>K
  <span class="token keyword">class</span> space    used <span class="token number">399</span>K<span class="token punctuation">,</span> capacity <span class="token number">428</span>K<span class="token punctuation">,</span> committed <span class="token number">512</span>K<span class="token punctuation">,</span> reserved <span class="token number">1048576</span>K
</code></pre></div><h3 id="g1-gc日志分析"><a href="#g1-gc日志分析" class="header-anchor">#</a> <s>G1 GC日志分析</s></h3></div></section> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/lasilaso/blog/edit/master/docs/jvm/jvm.md" target="_blank" rel="noopener noreferrer">在GitHub上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间: </span> <span class="time">2022/3/8 12:03:40</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/blog/jvm/jvm.html#jvm-内存区域" class="sidebar-link reco-side-jvm-内存区域" data-v-cb1513f6>JVM 内存区域</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#线程私有" class="sidebar-link reco-side-线程私有" data-v-cb1513f6>线程私有</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#线程共享" class="sidebar-link reco-side-线程共享" data-v-cb1513f6>线程共享</a></li><li class="level-2" data-v-cb1513f6><a href="/blog/jvm/jvm.html#如何判断对象死亡" class="sidebar-link reco-side-如何判断对象死亡" data-v-cb1513f6>如何判断对象死亡</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#引用计数算法" class="sidebar-link reco-side-引用计数算法" data-v-cb1513f6>引用计数算法</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#可达性分析算法" class="sidebar-link reco-side-可达性分析算法" data-v-cb1513f6>可达性分析算法</a></li><li class="level-2" data-v-cb1513f6><a href="/blog/jvm/jvm.html#了解哪些-gc-算法" class="sidebar-link reco-side-了解哪些-gc-算法" data-v-cb1513f6>了解哪些 GC 算法</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#标记-清除算法" class="sidebar-link reco-side-标记-清除算法" data-v-cb1513f6>标记-清除算法</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#标记-整理算法" class="sidebar-link reco-side-标记-整理算法" data-v-cb1513f6>标记-整理算法</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#标记-复制算法" class="sidebar-link reco-side-标记-复制算法" data-v-cb1513f6>标记-复制算法</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#三种算法简要对比" class="sidebar-link reco-side-三种算法简要对比" data-v-cb1513f6>三种算法简要对比</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#分代回收算法-策略" class="sidebar-link reco-side-分代回收算法-策略" data-v-cb1513f6>分代回收算法(策略)</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#基于region的回收策略" class="sidebar-link reco-side-基于region的回收策略" data-v-cb1513f6>基于region的回收策略</a></li><li class="level-2" data-v-cb1513f6><a href="/blog/jvm/jvm.html#了解哪些垃圾收集器" class="sidebar-link reco-side-了解哪些垃圾收集器" data-v-cb1513f6>了解哪些垃圾收集器</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#新生代-2" class="sidebar-link reco-side-新生代-2" data-v-cb1513f6>新生代</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#老年代-2" class="sidebar-link reco-side-老年代-2" data-v-cb1513f6>老年代</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#基于region的垃圾收集器" class="sidebar-link reco-side-基于region的垃圾收集器" data-v-cb1513f6>基于region的垃圾收集器</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#低延时垃圾收集器" class="sidebar-link reco-side-低延时垃圾收集器" data-v-cb1513f6>低延时垃圾收集器</a></li><li class="level-2" data-v-cb1513f6><a href="/blog/jvm/jvm.html#总结" class="sidebar-link reco-side-总结" data-v-cb1513f6>总结</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#gc-名词解释" class="sidebar-link reco-side-gc-名词解释" data-v-cb1513f6>GC 名词解释</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#gc调优策略" class="sidebar-link reco-side-gc调优策略" data-v-cb1513f6>GC调优策略</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#结束语" class="sidebar-link reco-side-结束语" data-v-cb1513f6>结束语</a></li><li class="level-2" data-v-cb1513f6><a href="/blog/jvm/jvm.html#参考" class="sidebar-link reco-side-参考" data-v-cb1513f6>参考</a></li><li class="level-2" data-v-cb1513f6><a href="/blog/jvm/jvm.html#附录" class="sidebar-link reco-side-附录" data-v-cb1513f6>附录</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#cms-gc-日志分析" class="sidebar-link reco-side-cms-gc-日志分析" data-v-cb1513f6>CMS GC 日志分析</a></li><li class="level-3" data-v-cb1513f6><a href="/blog/jvm/jvm.html#g1-gc日志分析" class="sidebar-link reco-side-g1-gc日志分析" data-v-cb1513f6>~~G1 GC日志分析~~</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/blog/assets/js/app.376fd355.js" defer></script><script src="/blog/assets/js/3.b189d65b.js" defer></script><script src="/blog/assets/js/1.879802dd.js" defer></script><script src="/blog/assets/js/13.ec994a62.js" defer></script>
  </body>
</html>
