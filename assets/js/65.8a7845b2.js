(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{420:function(a,t,r){"use strict";r.r(t);var s=r(43),e=Object(s.a)({},(function(){var a=this,t=a.$createElement,r=a._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h1",{attrs:{id:"缓存三大问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缓存三大问题"}},[a._v("#")]),a._v(" 缓存三大问题")]),a._v(" "),r("h2",{attrs:{id:"缓存击穿"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缓存击穿"}},[a._v("#")]),a._v(" 缓存击穿")]),a._v(" "),r("p",[r("strong",[a._v("当许多请求在访问同一个key时，这个key失效了，导致大量请求打到数据库上。")])]),a._v(" "),r("h3",{attrs:{id:"问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),r("p",[a._v("数据库的访问量突增，压力变大，可能会导致数据库宕机。")]),a._v(" "),r("h3",{attrs:{id:"解决方案"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),r("p",[a._v("加锁，当缓存的key为空时，对第一个到数据查询的线程加锁，把其他线程拦在后边，当第一个线程查询到数据，然后重建缓存后，其他线程就可以直接从缓存中获取数据。")]),a._v(" "),r("h2",{attrs:{id:"缓存穿透"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缓存穿透"}},[a._v("#")]),a._v(" 缓存穿透")]),a._v(" "),r("p",[r("strong",[a._v("查询不存在的数据，比如说，缓存和数据库中都没有查询key，导致每次都要到数据库中查询。")])]),a._v(" "),r("h3",{attrs:{id:"问题-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#问题-2"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),r("p",[a._v("如果有黑客使用不存在的key对系统进行访问，就会导致全部的请求打到数据库上，数据库的访问量突增，压力变大，可能会导致数据库宕机。")]),a._v(" "),r("h3",{attrs:{id:"解决方案-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#解决方案-2"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),r("ol",[r("li",[a._v("缓存null值")]),a._v(" "),r("li",[a._v("BloomFilter")])]),a._v(" "),r("h2",{attrs:{id:"缓存雪崩"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缓存雪崩"}},[a._v("#")]),a._v(" 缓存雪崩")]),a._v(" "),r("p",[r("strong",[a._v("在某一时刻，大量和缓存失效，导致原本应该访问缓存的请求全部打在数据库上。")])]),a._v(" "),r("h3",{attrs:{id:"问题-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#问题-3"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),r("p",[a._v("大量缓存失效，导致全部的请求打到数据库上，数据库的访问量突增，压力变大，可能会导致数据库宕机。")]),a._v(" "),r("h3",{attrs:{id:"解决方案-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#解决方案-3"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),r("h3",{attrs:{id:"热点key集中失效（缓存雪崩的变种）"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#热点key集中失效（缓存雪崩的变种）"}},[a._v("#")]),a._v(" 热点key集中失效（缓存雪崩的变种）")]),a._v(" "),r("h3",{attrs:{id:"解决方案-4"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#解决方案-4"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),r("p",[a._v("给不同的key设置不同的缓存时间，比如说，在固定时间上再加一个随机值。")]),a._v(" "),r("h2",{attrs:{id:"缓存和数据库的双写一致性"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缓存和数据库的双写一致性"}},[a._v("#")]),a._v(" 缓存和数据库的双写一致性")]),a._v(" "),r("h3",{attrs:{id:"问题-4"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#问题-4"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),r("h3",{attrs:{id:"解决方案-5"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#解决方案-5"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),r("h2",{attrs:{id:"延伸问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#延伸问题"}},[a._v("#")]),a._v(" 延伸问题")]),a._v(" "),r("ul",[r("li",[r("p",[a._v("大key是如何产生的，多大算大key")])]),a._v(" "),r("li",[r("p",[a._v("热key产生的原因及解决方案")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);